<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src\site\markdown/index.md at 2021-04-08
 | Rendered using Apache Maven Fluido Skin 1.9
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <title>WiiDrumsDrummed &#x2013; Wii Drums, Drummed</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.9.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.9.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h2>Wii Drums Drummed</h2>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li class="active"><a href="#"><span class="none"></span>Introduction</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" title="Built by Maven" class="builtBy"><img class="builtBy"  alt="Built by Maven" src="images/logos/maven-feather.png"   width="0"  /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<section>
<h2><a name="Wii_Drums.2C_Drummed"></a>Wii Drums, Drummed</h2>
<p><a class="externalLink" href="https://github.com/AJEvans/WiiDrumsDrummed/releases/tag/v0.1.0">Release 0.1</a> (C# application)</p><section>
<h3><a name="Summary:"></a>Summary:</h3>
<p>With a bit of effort, it&#x2019;s possible to get Wii Drums (in my case Guitar Hero World Tour drums) to work with a PC, so they play samples. After various attempts to follow online tutorials and/or get various bits of software to work, I gave up and wrote my own (I tried both commercial options and various free Programmable Input Emulators). The code isn&#x2019;t especially complicated, and it ain&#x2019;t pretty, but I thought I&#x2019;d upload it just incase someone else was struggling with it. It relies on the excellent <a class="externalLink" href="https://channel9.msdn.com/coding4fun/articles/Managed-Library-for-Nintendos-Wiimote">library written by Microsoft&#x2019;s Brian Peek</a>. You can download it most safely direct from Brian&#x2019;s <a class="externalLink" href="https://github.com/BrianPeek/WiimoteLib/releases">GitHub Repo</a>. You&#x2019;ll need <a class="externalLink" href="https://visualstudio.microsoft.com/downloads/">Visual Studio or Code</a> to compile the code. You&#x2019;ll need to install the C# component. You&#x2019;ll also need some drum samples. A good starting point is <a class="externalLink" href="https://www.musicradar.com/news/drums/sampleradar-1000-free-drum-samples-229460">Music Radar</a>.</p>
<p><a href="images/screenshot.png"><img src="images/screenshot_tn.png" alt="a screenshot of the code" /></a></p></section><section>
<h3><a name="To_run_the_code:"></a>To run the code:</h3>
<p>First, download the <a class="externalLink" href="https://github.com/BrianPeek/WiimoteLib/releases">WiimoteLib library</a> as a zip and unzip it somewhere you can find.</p>
<p>Next, open up Visual Studio and make a new &#x201c;Windows Form App&#x201d;.</p>
<p>Go to the &#x201c;Project&#x201d; menu, and select &#x201c;Add Reference&#x2026;&#x201d;. Go to &#x201c;Browse&#x201d; and click the &#x201c;Browse&#x2026;&#x201d; button. Add your WiimoteLib.dll.</p>
<p>Now choose 5 drum samples, and add these to your code. To do this, right-click the &#x201c;WindowsFormsApp1&#x201d; in the Solution Explorer, and open its properties. Click &#x201c;Resources&#x201d; and create a Resource File by clicking the message. Click the &#x201c;Add Resource&#x201d; menu and &#x201c;Add Existing Resource&#x201d;. Add all your samples.</p>
<p>Click back on &#x201c;Form1.cs&#x201d; and copy and paste my code in. Where the code currently says &#x201c;Properties.Resources.CYCdh_K5_Snr04&#x201d; etc, remove the &#x201c;CYCdh_K5_Snr04&#x201d; and replace with the names of your own sample resources. The autocomplete should show these if you delete the last period and type it again.</p>
<p>Next we need to link the drums. Make sure BlueTooth is on on your PC. Turn on the Wii controller, with the battery pack open and press the red button inside the case. You should see the LEDs on the controller flash. If they stop flashing before you connect, push the button again. If you&#x2019;re using some kind of rechargable pack, you can apparently push the &#x201c;1&#x201d; and &#x201c;2&#x201d; buttons together instead, but I had less luck with this.</p>
<p>Now right-click the BlueTooth icon on your taskbar. Select &#x201c;Join a Personal Area Network&#x201d; and &#x201c;Add a device&#x201d;. You should see the controller appear as either &#x201c;Nintendo RVL-CTL-01&#x201d; or &#x201c;Input Device&#x201d; or similar. Click on it and wait for it to install the suitable files. The best way to test it has linked is to open the &#x201c;WiimoteTest.exe&#x201d; example application that comes with WiimoteLib. If it says there&#x2019;s no suitable controller, try again. It sometimes takes two or three goes to get it to connect.</p>
<p><b>NOTE</b>: Wii controls aren&#x2019;t great at connecting to PCs. I&#x2019;ve found that the best way to keep them connected is to open the &#x201c;WiimoteTest.exe&#x201d; application that comes with WiimoteLib while I&#x2019;m not using them. This will crash when you run the code here, but that&#x2019;s fine. If you lose the controller connection, it probably won&#x2019;t reconnect automatically. This is a real pain. You have to right-click on your BlueTooth icon, select &#x201c;Show BlueTooth Devices&#x201d;, delete the controller, and then go through the &#x201c;Join a Personal Area Network&#x201d; again. I found after a few times, I had to reboot my machine to get it to work.</p>
<p>Once the controller is connected, press the &#x201c;Start&#x201d; button in Visual Studio, and the code should run. Drum!</p></section><section>
<h3><a name="Caveat_coder:"></a>Caveat coder:</h3>
<p>You&#x2019;ll probably notice a lag between the drum and the sound. This is as small as I can get it (the sounds run in separate threads). I think the solution is probably to do the whole thing with an Arduino within the drum kit, but that&#x2019;ll have to wait for the next holiday. In addition, our drum set seems to send multiple hit signals from multiple drums when you hit one of them, so the whole thing is a bit chaotic. Hopefully for anyone else with a newer set, this won&#x2019;t be an issue. If you think there&#x2019;s an improvement that can be made, do drop me a line!</p></section></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
0.1
			<br>
			07 Apr 2021
			<br>Author: <a href="https://ajevans.github.io/">Andy Evans</a>
			<br>Licence: <a href="https://opensource.org/licenses/MIT">MIT</a>
        </div>
      </div>
    </footer>
  </body>
</html>
